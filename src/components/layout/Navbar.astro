---
import { cn } from "@/lib/utils";
import logo from "../../images/logo-v1.webp";
import { Image } from "astro:assets";
import { navLinks, socialLinks } from "@/config/links";
import { PanelRightOpen } from "lucide-react";

interface Props {
  className?: string;
}

const { className } = Astro.props;
---

<header
  class={cn(
    className,
    "w-full px-4 h-20 mt-4 sm:mt-6 fixed top-0 left-0 right-0 z-50",
  )}
>
  <!-- TODO: Modify once we have mobile designs -->
  <nav
    class="mx-auto flex max-w-6xl items-center justify-between rounded-full border-[1.5px] border-white bg-gradient-to-br from-white/50 to-white/30 px-3 pb-2 pt-2.5 text-center text-black backdrop-blur-sm max-sm:rounded-lg sm:px-6 md:px-6 lg:px-10"
  >
    <div class="flex w-full items-center gap-8 max-lg:justify-between">
      <!-- Logo -->
      <Image
        src={logo}
        alt="logo"
        width={144}
        height={144}
        class="size-12 object-contain max-sm:size-10"
      />

      <!-- TODO: Add a mobile menu -->
      <PanelRightOpen className="text-[#0A1F44] sm:hidden" />

      <ul class="flex items-center gap-8 max-sm:hidden">
        {
          navLinks.map((link) => (
            <li class="group relative font-bold">
              <a href={link.href} class="xl:text-lg">
                {link.label}
              </a>
              <span class="absolute inset-x-0 bottom-0 h-0.5 scale-x-0 rounded-full bg-black transition-transform duration-200 group-hover:scale-x-100" />
            </li>
          ))
        }
      </ul>
    </div>

    <!-- Social Links -->
    <ul class="flex shrink-0 items-center gap-8 max-lg:hidden">
      {
        socialLinks.map((link) => (
          <li>
            <a href={link.href} target="_blank" rel="noopener noreferrer">
              <Image
                src={link.icon}
                alt={link.label || link.href}
                width={32}
                height={32}
                class="size-6 xl:size-7"
              />
            </a>
          </li>
        ))
      }
    </ul>
  </nav>
</header>

<!-- Add the following script tag for the scrolling logic -->
<script>
  import { gsap } from "gsap";

  const navbar = document.querySelector("header");

  // Initial animation
  gsap.from(navbar, {
    y: -100,
    duration: 0.5,
    ease: "power3.out",
  });

  let lastScrollTop = 0;

  // Pop up on scroll up
  const showNavbar = () => {
    gsap.to(navbar, { y: 0, duration: 0.3, ease: "power3.out" });
  };

  // Hide on scroll down
  const hideNavbar = () => {
    if (!navbar) return;

    gsap.to(navbar, {
      y: -100,
      duration: 0.5,
      ease: "power3.out",
    });
  };

  window.addEventListener("scroll", () => {
    const scrollTop = window.scrollY || document.documentElement.scrollTop;

    if (scrollTop < 100) {
      showNavbar();
    } else if (scrollTop > lastScrollTop) {
      hideNavbar();
    } else {
      showNavbar();
    }

    lastScrollTop = scrollTop <= 0 ? 0 : scrollTop;
  });
</script>
