---
import { cn } from "@/lib/utils";
import NavbarToggle from "./NavbarToggle.astro";
import NavLinks from "./NavLinks.astro";
import Image from "astro/components/Image.astro";
import logo from "../../../images/logo-v1.webp";
import NavbarSocials from "@/components/layout/navbar/NavbarSocials.astro";

interface Props {
  className?: string;
}

const { className } = Astro.props;
---

<header
  class={cn(
    className,
    "w-full px-4 h-20 mt-4 sm:mt-6 fixed top-0 left-0 right-0 z-50",
  )}
>
  <!-- TODO: Modify once we have mobile designs -->
  <nav
    class="mx-auto flex max-w-6xl items-center justify-between rounded-full border-[1.5px] border-white bg-gradient-to-br from-white/50 to-white/30 px-3 pb-2 pt-2.5 text-center text-black backdrop-blur-sm max-sm:rounded-lg sm:px-6 md:px-6 lg:px-10"
  >
    <div class="flex w-full items-center gap-8 max-lg:justify-between">
      <a href="/" class="flex items-center">
        <Image
          src={logo}
          alt="logo"
          width={144}
          height={144}
          class="size-12 object-contain max-sm:size-10"
        />
      </a>
      <NavbarToggle />
      <NavLinks />
    </div>

    <NavbarSocials />
  </nav>
</header>

<!-- Add the following script tag for the scrolling logic -->
<script>
  import { gsap } from "gsap";

  const navbar = document.querySelector("header");

  // Initial animation
  gsap.from(navbar, {
    y: -100,
    duration: 0.5,
    ease: "power3.out",
  });

  let lastScrollTop = 0;

  // Pop up on scroll up
  const showNavbar = () => {
    gsap.to(navbar, { y: 0, duration: 0.3, ease: "power3.out" });
  };

  // Hide on scroll down
  const hideNavbar = () => {
    if (!navbar) return;

    gsap.to(navbar, {
      y: -100,
      duration: 0.5,
      ease: "power3.out",
    });
  };

  window.addEventListener("scroll", () => {
    const scrollTop = window.scrollY || document.documentElement.scrollTop;

    if (scrollTop < 100) {
      showNavbar();
    } else if (scrollTop > lastScrollTop) {
      hideNavbar();
    } else {
      showNavbar();
    }

    lastScrollTop = scrollTop <= 0 ? 0 : scrollTop;
  });
</script>
